üìö Manual del Curso: Creaci√≥n del Backend E-commerce en Supabase para React
Este manual detalla la migraci√≥n de la base de datos damasco a Supabase y la configuraci√≥n inicial del proyecto para integrarlo con React.

üéØ Objetivo General
Migrar el esquema de 11 tablas (incluyendo productos, categorias y pedidos) de MySQL (phpMyAdmin) a PostgreSQL (Supabase) y obtener las credenciales API.

Parte 1: Pre-migraci√≥n ‚Äì Exportaci√≥n de Datos a CSV (phpMyAdmin)
El objetivo es extraer los datos de todas las tablas en un formato universal (CSV) para asegurar una importaci√≥n limpia.

1.1 Tablas a Exportar
    Debemos tener un archivo CSV para cada una de las siguientes tablas:

    carritos
    categorias
    dolar
    estatus
    items_carrito
    items_pedido
    marcas
    pedidos
    productos
    subcategorias
    usuarios

1.2 Proceso de Exportaci√≥n
    Acceder a la Tabla: Abre tu entorno phpMyAdmin (ej: localhost:3306/damasco/). En el panel izquierdo, haz clic en la tabla que deseas exportar (ej: categorias).

    Pesta√±a Exportar: En la barra de pesta√±as superior, haz clic en "Exportar" (Export).

    Configuraci√≥n:

        M√©todo de Exportaci√≥n: Selecciona "Personalizado" (Custom).
        Formato de Salida: Verifica que est√© seleccionado "CSV".
        Opciones Espec√≠ficas del Formato (CRUCIAL): Aseg√∫rate de que la casilla "Incluir nombres de columna en la primera fila" est√© marcada.

    Descargar: Despl√°zate hasta el final de la p√°gina y haz clic en el bot√≥n "Continuar" (Go). El navegador descargar√° el archivo CSV (ej: categorias.csv).

    Repetir: Repite este proceso para las 11 tablas.

Parte 2: Configuraci√≥n del Backend (Supabase)
    El objetivo es crear el proyecto y cargar los datos de los CSV.

    2.1 Creaci√≥n de Cuenta y Proyecto
        Crear la Cuenta: Reg√≠strate en Supabase.

        Correo: cursoreact@arsistemaweb.com
        Clave: )8&FcDX2o6t1Tzfv

        Crear Proyecto: Una vez en la organizaci√≥n, haz clic en "New Project".

            Name: DamascoStore (o damasco).
            Database Password: DX2o6t1Tzfv (Clave de la base de datos).
            Region: Selecciona la regi√≥n geogr√°fica m√°s cercana.

            Haz clic en "Create new project".

    2.2 Importaci√≥n de Tablas (CSV)
        Navegar al Editor: Una vez dentro del proyecto, en el men√∫ lateral izquierdo, haz clic en el icono de la base de datos, llamado "Table Editor" (Editor de Tablas).

        Iniciar Importaci√≥n: Haz clic en el bot√≥n "+ New Table".

            Seleccionar CSV: En lugar de "Create a new table", selecciona la opci√≥n "Import data from CSV".

        Importar:

            Table Name: Escribe el nombre de la tabla (ej: productos).

            Source: Selecciona "Upload File" y sube el archivo CSV correspondiente (ej: productos.csv).

            Revisar e Importar: Revisa que la previsualizaci√≥n de datos sea correcta y haz clic en "Import".

            Repetir: Repite este proceso para todas las 11 tablas.

Parte 3: Ajustes Finales de la Base de Datos
    Una vez que los datos est√°n cargados, es fundamental establecer las relaciones y tipos de datos correctos para que el backend funcione.

    3.1 Definici√≥n de Llaves Primarias (PK)
        Acci√≥n: En el Table Editor, selecciona cada tabla, ve a la configuraci√≥n de la columna id y aseg√∫rate de que est√© configurada como:

        Primary Key (PK): S√≠

        Identity: S√≠ (Auto-incremento)

        Not Null: S√≠

3.2 Correcci√≥n de Tipos de Datos (Moneda)
    Correcci√≥n Importante: En las tablas que manejan moneda (como pedidos), las columnas con valores decimales deben ser de tipo numeric o double precision, no bigint.

    Selecciona la tabla pedidos.

    Edita la columna total y cambia su tipo a numeric.

    Edita la columna tasa_dolar_usada y cambia su tipo a numeric.

    Repite esta revisi√≥n para cualquier otra columna de precio/total en tablas como productos o items_pedido.

3.3 Definici√≥n de Llaves For√°neas (FK)
    Las llaves for√°neas conectan las tablas. Deben definirse en las tablas que referencian a otras (ej: productos referencia a categorias).
    Tabla	Columna FK	Referencia a Tabla
    subcategorias	idcategoria	categorias
    productos	idcategoria	categorias
    productos	idsubcategoria	subcategorias
    productos	idmarca	marcas
    pedidos	usuario_id	usuarios
    items_pedido	pedido_id	pedidos
    items_pedido	producto_id	productos
    items_carrito	carrito_id	carritos
    items_carrito	producto_id	productos

Parte 4: Obtenci√≥n de Credenciales y Preparaci√≥n de React
    Una vez que la base de datos est√° perfecta, obtenemos las claves para conectar nuestro frontend de React.

    En el men√∫ lateral, ve a "Project Settings" (‚öôÔ∏è) y luego a "API".

    Copia las siguientes credenciales (que ser√°n usadas en el cliente de Supabase en React):

   

4.1 Obtenci√≥n de Credenciales (Supabase Dashboard)

    1. En tu Dashboard de Supabase, ve a "Project Settings" (‚öôÔ∏è) y luego a "API".
    2. Copia los dos valores clave. Los nombraremos seg√∫n la convenci√≥n de React (REACT_APP_): 
         
    Credencial,                 Nombre en tu .env,                                      Valor (Ejemplo)
    Project URL,                VITE_REACT_APP_SUPABASE_URL,                            https://ctkmstznoyaxsszowzch.supabase.co
    Anon Public Key,            VITE_REACT_APP_SUPABASE_ANON_KEY,                       sb_publishable_IE84Dnel98IjFzhPzZ1cYw_qZsut3EK

4.2 Configuraci√≥n del Archivo .env    

    1. En la ra√≠z de tu proyecto React, crea un nuevo archivo llamado: .env.local

    2. Pega las credenciales copiadas usando los nombres de las variables:

        # .env.local (en la ra√≠z del proyecto)
        # ----------------------------------------------------
        # ‚ö†Ô∏è ADVERTENCIA: NUNCA COMPARTIR ESTE ARCHIVO
        # ----------------------------------------------------
        VITE_REACT_APP_SUPABASE_URL="https://ctkmstznoyaxsszowzch.supabase.co"
        VITE_REACT_APP_SUPABASE_ANON_KEY="sb_publishable_IE84Dnel98IjFzhPzZ1cYw_qZsut3EK"

4.3 Inicializaci√≥n del Cliente Supabase en React

        1. Instalar SDK
            npm install @supabase/supabase-js

        2. Crear Cliente (Archivo src/supabaseClient.js)
            Crea este archivo e inicializa el cliente utilizando las variables de entorno, 
            haciendo el c√≥digo limpio y profesional:

            // src/supabaseClient.js

            import { createClient } from '@supabase/supabase-js';

            // 1. Cargar las variables de entorno de manera segura:
            const supabaseUrl = import.meta.env.VITE_REACT_APP_SUPABASE_URL;
            const supabaseKey = import.meta.env.VITE_REACT_APP_SUPABASE_ANON_KEY;

            // 2. Comprobaci√≥n (opcional, pero √∫til para depurar):
            if (!supabaseUrl || !supabaseKey) {
                console.error("Error: Las variables de entorno de Supabase no est√°n configuradas correctamente.");
            }

// 3. Crear y exportar el cliente:
export const supabase = createClient(supabaseUrl, supabaseKey);

// NOTA: Si usas Create React App (CRA), usa: process.env.REACT_APP_SUPABASE_URL

    Pr√≥ximo Paso: Desarrollo de la Tienda (Lectura - READ)
        Ahora que el cliente est√° configurado y la base de datos est√° lista, el siguiente paso es empezar a leer los datos para mostrar el cat√°logo:

import { useEffect, useState } from "react";
import { supabase } from '../supabaseClient';

const FiltroCategorias = () => {
    const [datos, setDatos] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);

    const getDatos = async () => {
        try {
            const { data, error } = await supabase
                .from('categorias')
                // Solo necesitamos el id y el nombre para la navegaci√≥n
                .select('id, nombre'); 

            if (error) {
                throw new Error(error.message || 'Error desconocido al obtener categor√≠as.');
            }

            setDatos(data); // Almacenar los datos
            setLoading(false);  // Finalizar carga
        } catch (err) {
            console.error('Error al obtener categor√≠as:', err);
            setError(err.message);
            setLoading(false);
        }
    };

   
    useEffect(() => {
        getDatos();
    }, []); 
    if (loading) {
        return (
            <div className="text-center p-3">
                <p>Cargando categor√≠as...</p>
            </div>
        );
    }
    if (error) {
        return (
            <div className="p-3 text-danger">
                <p>Error: {error}</p>
            </div>
        );
    }
    return (
       
           
            <ul className="list-group list-group-flush">
                {datos.map((item) => (
                    // Usamos item.id como key. En el futuro, aqu√≠ ir√° la l√≥gica de filtrado.
                    <li key={item.id} className="list-group-item list-group-item-action">
                        {item.nombre}
                    </li>
                ))}
            </ul>
       
    )
}

export default FiltroCategorias




Manual: Subida de Im√°genes con Supabase Storage
    1. Configuraci√≥n Inicial en Supabase (Storage)
        Primero, debemos crear un lugar p√∫blico donde almacenar las im√°genes.

        Navega a Storage: En tu Dashboard de Supabase, 
        haz clic en el icono de la carpeta o nube llamado "Storage" (Almacenamiento).

        Crear un Nuevo Bucket: Haz clic en "New bucket".

        Name: Llama al bucket imagenes_productos (o product_images).

        Public access: Aseg√∫rate de marcar la casilla "Public bucket" (Contenedor P√∫blico). Esto es crucial para que las im√°genes sean visibles en tu tienda sin necesidad de autenticaci√≥n.

        Guarda el Bucket.

        2. Funci√≥n de Subida en React
        Debido a que subir archivos es una operaci√≥n diferente a las consultas de datos, usaremos el objeto storage del cliente de Supabase.

        Aqu√≠ tienes la funci√≥n que puedes reutilizar para subir cualquier archivo 
        (File de JavaScript) al bucket que acabamos de crear.